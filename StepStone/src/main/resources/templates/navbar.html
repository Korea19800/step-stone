<!doctype html>
<html lang="ko"
      xmlns:th="http://thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<!-- JavaScript Bundle with Popper -->
<!-- 헤더 navbar -->
<nav th:fragment="navbarFragment" class="navbar navbar-expand-lg" style="background-color: #F3F6FA;">
    <div class="container-fluid">
        <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet"/>
        <!-- 로고 부분 -->
        <a class="navbar-brand px-3" href="/">
            <img src="/stepstone_icon.png" width="55" height="55"/>
        </a>

        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent"
                aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <!-- 기본 메뉴들 부분 -->
        <div class="collapse navbar-collapse justify-content-center" id="navbarSupportedContent">
            <ul class="navbar-nav">
                <li class="nav-item px-4">
                    <a class="nav-link" th:href="@{|/post/list|}"><strong>게시글 목록</strong></a>
                </li>
                <li class="nav-item px-4">
                    <a class="nav-link" th:href="@{|/workspace/list|}"><strong>워크스페이스</strong></a>
                </li>
                <li class="nav-item px-4">
                    <a class="nav-link" th:href="@{|/project/list|}"><strong>완성된 프로젝트</strong></a>
                </li>
                <li class="nav-item px-4">
                    <a class="nav-link" th:href="@{|/chat/room|}"><strong>채팅방 바로가기</strong></a>
                </li>
                <li class="nav-item px-4">
                    <a class="nav-link" th:href="@{|/mypage|}"><strong>마이페이지</strong></a>
                </li>
            </ul>
        </div>

        <!-- 알림 아이콘 부분 -->
        <div class="justify-content-center">
            <ul class="navbar-nav">
                <!--                <li class="nav-item">-->
                <!--                    <a class="nav-link" href="">-->
                <!--                        <i class="fa-solid fa-bell"></i>-->
                <!--                    </a>-->
                <!--                </li>-->
                <li class="nav-item" sec:authorize="isAuthenticated()">
                    <i th:if="${!hasNotification}" class="fa fa-bell-o" aria-hidden="true"></i>
                    <div class="dropdown-center" id="dropdown">

                        <a th:if="${hasNotification}" class="text-info fa fa-bell dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-hidden="true"></a>
                        <ul class="dropdown-menu" id="dropdown-menu">
                            <li th:each="notification : ${notifications}">
                                <a class="dropdown-item" th:text="${notification.title}"
                                   style="font-size : 12px" data-bs-toggle="collapse"
                                th:href="'#collapse' + ${notification.id}" aria-expanded="false" th:attr="aria-controls='#collapse' + ${notification.id}">Action</a>
                                <!--                                   th:attr="data-bs-target='#collapse' + ${notification.id}"-->
                                <div class="collapse ms-1 mt-1" th:id="'collapse' + ${notification.id}" >
                                <div style="font-size : 10px" th:text="${notification.message}">
                                    Lorem ipsum dolor text....
                                </div>
                                </div>
                            </li>
                        </ul>
                    </div>
                </li>
            </ul>
        </div>

        <!-- 로그인, 회원가입 부분 -->
        <div class="d-flex flex-row justify-content-around px-3">
            <ul class="navbar-nav gap-2">
                <li class="nav-item px-2">
                    <!-- sec:authorize="isAnonymous()" : 로그아웃 상태일 때 만 렌더링 -->
                    <a class="nav-link" sec:authorize="isAnonymous()" th:href="@{/login}">로그인</a>
                    <!--sec:authorize="isAuthenticated()" : 로그인 상태일 때 만 렌더링 -->
                    <a class="nav-link" sec:authorize="isAuthenticated()" th:href="@{/logout}">로그아웃</a>
                </li>
                <li class="nav-item">
                    <a role="button" sec:authorize="isAnonymous()" th:href="@{/join}" class="btn" style="background-color: #3C64B1; color: #dddddd">회원가입</a>
                </li>
            </ul>
        </div>

    </div>
    <script>
        function stopProp(event) {
            event.stopPropagation();
        }

        let textarea = document.getElementById('dropdown-menu');
        // 이벤트 리스너가 catch 한 이벤트를 submitTextarea 에 넘겨줍니다.
        textarea.addEventListener('click', event => stopProp(event));

    </script>
</nav>

</html>
